import customtkinter as ctk
import threading
from selenium import webdriver
# --- NEW: Webdriver Manager ---
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
# --- End of New Import ---
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time
import re
import winsound 
import base64
from io import BytesIO
from PIL import Image, ImageTk 
import webbrowser 
import json # For config file (first-time check & settings)
import os # To check if config file exists
# --- NEW: Auto-Updater imports ---
import requests
import sys
import subprocess
# --- End of New Imports ---


# --- NEW: App Version & GitHub URL ---
# This is your app's current version
CURRENT_VERSION = "v1.0" # Namma v3.6-la settings fix panrom
# The API URL for your GitHub repo's latest release
GITHUB_REPO_API_URL = "https://api.github.com/repos/kalaiyarasanDev/ARMS-Register-Bot/releases/latest"
# --- End of New ---

# PASTE YOUR FULL BASE64 LOGO STRING HERE 
# (e.g., "iVBORw0KGgoAAAANSUhEUgA...")
LOGO_BASE64_STRING = "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AAAAAAACBHoAAAAAAAAACBDoAQAAAAAAACBAoAcAAAAAAACAAIEeAAAAAAAAAAIEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAAAAAIAAgR4AAAAAAAAAAgR6AAAAAAAAAAgQ6AEAAAAAAAAgQKAHAAAAAAAAgACBHgAAAAAAAAACBHoAAAAAAAAACBDoAQAAAAAAACBAoAcAAAAAAACAAIEeAAAAAAAAAAIEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAAAAAIAAgR4AAAAAAAAAxrO9eSHQAwAAAAAAAMB41jcvBHoAAAAAAAAACBDoAQAAAAAAACBAoAcAAAAAAACAAIEeAAAAAAAAAAIEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAACAaXjSegAAMC6BHgAAAAAApuFZ6wEAwLgEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAAAAAIAAgR4AAAAAAAAAAgR6AAAAAAAAAAgQ6AEAAAAAAAAgQKAHAAAAAAAAgACBHgAAAAAAAAACBHoAAAAAAAAACBDoAQAAAAAAACBAoAcAAAAAAACAAIEeAAAAAAAAAAIEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAAAAAIAAgR4AAAAAAAAAAgR6AAAAAAAAAAgQ6AEAAAAAAAAgQKAHAAAAAAAAgACBHgAAAAAAAAACBHoAAAAAAAAACBDoAQAAAAAAACBAoAcAAAAAAACAAIEeAAAAAAAAAAIEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAAAAAIAAgR4AAAAAAAAAAgR6AAAAAAAAAAgQ6AEAAAAAAAAgQKAHAAAAAAAAgACBHgAAAAAAAAACBHoAAAAAAAAACBDoAQAAAAAAACBAoAcAAAAAAACAAIEeAAAAAAAAAAIEegAAAAAAAAAIEOgBAAAAAAAAIECgBwAAAAAAAIAAgR4AAAAAAAAAAgR6AAAAAAAAAAgQ6AEAAAAAAAAgQKAHAAAAAAAAgACBHgAAAAAAAABG0nfD6ua1QA8AAAAAAAAAAQI9AAAAAAAAAAQI9AAAAAAAAAAQINADAAAAAAAAQIBADwAAAAAAAAABAj0AAAAAAAAABAj0AAAAAAAAABAg0AMAAAAAwDR0rQcAAOMS6AEAAAAAAAAgQKAHAAAAAAAAgACBHgAAAAAAAAACBHoAAAAA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9AAAAAAAAAAQEOgBAAAAAAAAICDQAwAAAAAAAEBAoAcAAAAAAACAgEAPAAAAAAAAAAGBHgAAAAAAAAACAj0AAAAAAAAABAR6AAAAAAAAAAgI9AAAAAAAAAAQEOgBAAAAAAAAICDQAwAAAAAAAEBAoAcAAAAAAACAgEAPAAAAAAAAAAGBHgAAAAAAAAACAj0AAAAAAAAABAR6AAAAAAAAAAgI9AAAAAAAAAAQEOgBAAAAAAAAICDQAwAAAAAAAEBAoAcAAAAAAACAgEAPAAAAAAAAAAGBHgAAAAAAAAACAj0AAAAAAAAABAR6AAAAAAAAAAgI9AAAAAAAAAAQEOgBAAAAAAAAICDQAwAAAAAAAEBAoAcAAAAAAACANZ77Q6AHAAAAAAAAgAW+P36e+1ugBwAAAAAAAICAQA8AAAAAAAAAAYEeAAAAAAAAAAICPQAAAAAAAAAEBHoAAAAAAAAACAj0AAAAAAAAABAQ6AEAAAAAYN51egAAsJ5ADwAAAAAA835NDwAA1hPoAQAAAAAAACAg0AMAAAAAAABAQKAHAAAAAAAAgIBADwAAAAAAAAABgR4AAAAAAAAAAgI9AAAAAAAAAAQEegAAAAAAAAAICPQAAAAAAAAAEBDoAQAAAAAAACAg0AMAAAAAAABAQKAHAAAAAAAAgIBADwAAAAAAAAABgR4AAAAAAAAAAgI9AAAAAAAAAAQEegAAAAAAAAAICPQAAAAAAAAAEBDoAQAAAAAAACAg0AMAAAAAAABAQKAHAAAAAAAAgIBADwAAAAAAAAABgR4AAAAAAAAAAgI9AAAAAAAAAAQEegAAAAAAAAAICPQAAAAAAAAAEBDoAQAAAAAAACAg0AMAAAAAAABAQKAHAAAAAAAAgIBADwAAAAAAAAABgR4AAAAAAAAAAgI9AAAAAAAAAAQEegAAAAAAAAAICPQAAAAAAAAAEBDoAQAAAAAAACAg0AMAAAAAAABAQKAHAAAAAAAAgIBADwAAAAAAAAABgR4AAAAAAAAAAgI9AAAAAAAAAAQEegAAAAAAAAAICPQAAAAAAAAAEBDoAQAAAAAAACAg0AMAAAAAAABAQKAHAAAAAAAAgPP9Oz4EegAAAAAAAAA43+P4EOgBAAAAAAAAICDQAwAAAAAAAEBAoAcAAAAAAACAgEAPAAAAAAAAAAGBHgAAAAAAAAACAj0AAAAA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AAAAAAAAIIFADwAAAAAAAAAJBHoAAAAAAAAASCDQAwAAAAAAAEACgR4AAAAAAAAAEgj0AAAAAAAAAJBAoAcAAAAAAACABAI9AAAAAAAAACQQ6AEAAAAAAAAggUAPAAAAAAAAAAkEegAAAAAAAABIINADAAAAAAAAQAKBHgAAAAAAAAASCPQAAAAAAAAAkECgBwAAAAAAAIAEAj0AAAAAAAAAJBDoAQAAAAAAACCBQA8AAAAAAAAACQR6AAAAAAAAAEgg0AMAAAAAAABAAoEeAAAAAAAAABII9AAAAAAAAACQQKAHAAAAAAAAgAQCPQAAAAAAAAAkEOgBAAAAAAAAIIFADwAAAAAAAAAJBHoAAAAAAAAASCDQAwAAAAAAAEACgR4AAAAAAAAAEgj0AAAAAAAAAJBAoAcAAAAAAACABAI9AAAAAAAAACQQ6AEAAAAAAAAggUAPAAAAAAAAAAkEegAAAAAAAABIINADAAAAAAAAQAKBHgAAAAAAAAASCPQAAAAAAAAAkECgBwAAAAAAAIAEAj0AAAAAAAAAJBDoAQAAAAAAACCBQA8AAAAAAAAACQR6AAAAAAAAAEgg0AMAAAAAAABAAoEeAAAAAAAAABII9AAAAAAAAACQQKAHAAAAAAAAgAQCPQAAAAAAAAAkEOgBAAAAAAAAIIFADwAAAAAAAAAJBHoAAAAAAAAASCDQAwAAAAAAAEACgR4AAAAAAAAAEgj0AAAAAAAAAJBAoAcAAAAAAACABAI9AAAAAAAAACQQ6AEAAAAAAAAggUAPAAAAAAAAAAkEegAAAAAAAABIINADAAAAAAAAQAKBHgAAAAAAAAASCPQAAAAAAAAAkECgBwAAAAAAAIAEAj0AAAAAAAAAJBDoAQAAAAAAACCBQA8AAAAAAAAACQR6AAAAAAAAAEgg0AMAAAAAAABAAoEeAAAAAAAAABII9AAAAAAAAACQQKAHAAAAAAAAgAQCPQAAAAAAAAAkEOgBAAAAAAAAIIFADwAAAAAAAAAJBHoAAAAAAAAASCDQAwAAAAAAAEACgR4AAAAAAAAAEgj0AAAAAAAAAJBAoAcAAAAAAACABAI9AAAAAAAAACQQ6AEAAAAAAAAggUAPAAAAAAAAAAkEegAAAAAAAABIINADAAAAAAAAQAKBHgAAAAAAAAASCPQAAAAAAAAAkECgBwAAAAAAAIAE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"


# Your tutorial video link
TUTORIAL_VIDEO_LINK = "https://drive.google.com/file/d/1dD0OJAGKlo_BuW7vVfRbJ293xkdLe15S/view?usp=drive_link"

# --- PUDHU MAATRAM: Config file-ah AppData-la save panrom ---
# Get the path to C:\Users\<YourName>\AppData\Roaming
APP_DATA_PATH = os.getenv('APPDATA')
# Create a dedicated folder for our app
APP_FOLDER = os.path.join(APP_DATA_PATH, "ARMSBot")
# Create the folder if it doesn't exist
os.makedirs(APP_FOLDER, exist_ok=True)
# Define the full path for the config file
CONFIG_FILE = os.path.join(APP_FOLDER, "config.json")
# --- End of Pudhu Maatram ---


# --- FEATURE: Popup Window Class ---
class PopupMessage(ctk.CTkToplevel):
    """A modal popup window that stays until manually closed."""
    def __init__(self, title, message, status_type):
        super().__init__()
        self.title(title)
        icon_text = "✅" if status_type == "success" else "❌"
        self.geometry("450x220") 
        self.attributes("-topmost", True)
        icon_label = ctk.CTkLabel(self, text=icon_text, font=("Arial", 30))
        icon_label.pack(pady=10)
        message_label = ctk.CTkLabel(self, text=message, wraplength=430, justify="left") 
        message_label.pack(pady=10, padx=20)
        ok_button = ctk.CTkButton(self, text="OK", command=self.destroy)
        ok_button.pack(pady=10)
        self.transient(self.master) 
        self.grab_set() 

# --- Main Application Window Setup ---
class App(ctk.CTk):
    def __init__(self):
        super().__init__()
        self.title("ARMS Register Bot")
        
        screen_width = self.winfo_screenwidth()
        screen_height = self.winfo_screenheight()
        self.geometry(f"{screen_width}x{screen_height}+0+0")
        
        ctk.set_appearance_mode("dark")
        ctk.set_default_color_theme("blue")

        # --- Logo Loading ---
        self.logo_image_splash = None
        self.logo_image_main = None
        self.logo_image_nav = None 
        self.icon_photo = None 
        try:
            if LOGO_BASE64_STRING != "...":
                image_data = base64.b64decode(LOGO_BASE64_STRING)
                pil_image = Image.open(BytesIO(image_data))
                
                self.logo_image_splash = ctk.CTkImage(pil_image, size=(96, 96))
                self.logo_image_main = ctk.CTkImage(pil_image, size=(48, 48))
                self.logo_image_nav = ctk.CTkImage(pil_image, size=(28, 28)) 
                
                self.icon_photo = ImageTk.PhotoImage(pil_image)
                self.iconphoto(True, self.icon_photo)
            else:
                print("Logo string not provided. Using defaults.")
        except Exception as e:
            print(f"Error loading logo: {e}. Using defaults.")

        self.active_bots = [] 
        self.is_password_visible = False 
        self.current_viewed_bot = None
        
        # --- Smart Bot Logic variables ---
        self.taken_slots_by_user = {} # e.g., {'username': {'Slot A', 'Slot B'}}
        self.taken_slots_lock = threading.Lock() # For thread-safety
        
        # --- First Time Check ---
        self.first_time_user = True # Default
        self.check_if_first_time() 
        self.welcome_popup = None 
        
        # --- App has 6 pages (Frames) ---
        self.splash_frame = ctk.CTkFrame(self, fg_color="transparent")
        self.dashboard_frame = ctk.CTkFrame(self, fg_color="transparent")
        self.form_frame = ctk.CTkFrame(self) 
        self.result_frame = ctk.CTkFrame(self, fg_color="transparent") 
        self.settings_frame = ctk.CTkFrame(self, fg_color="transparent") 
        self.about_frame = ctk.CTkFrame(self, fg_color="transparent") 
        self.log_frame = ctk.CTkFrame(self, fg_color="transparent") 
        # --- End of Frames ---

        # Validation variables
        self.is_username_valid = False
        self.is_password_valid = False
        self.is_course_valid = False
        self.is_slot_valid = False
        self.default_border_color = ctk.ThemeManager.theme["CTkEntry"]["border_color"]
        self.default_border_width = ctk.ThemeManager.theme["CTkEntry"]["border_width"]

        # Create all pages (hidden)
        self.create_splash_screen() 
        self.create_dashboard_widgets() 
        self.create_form_widgets()  
        self.create_result_widgets() 
        self.create_settings_widgets() 
        self.create_about_widgets() 
        self.create_log_widgets() 
        
        # --- NEW: Load saved settings from config.json ---
        self.load_settings()
        
        # Show splash screen first
        self.splash_frame.pack(fill="both", expand=True)
        self.after(3000, self.show_dashboard) 
        
        # --- NEW: Check for updates 5 seconds after launch ---
        self.after(5000, self.start_update_check) 

    # --- Page 1: Splash Screen ---
    def create_splash_screen(self):
        """Creates the loading page shown on app start."""
        center_frame = ctk.CTkFrame(self.splash_frame, fg_color="transparent")
        center_frame.place(relx=0.5, rely=0.5, anchor="center")
        if self.logo_image_splash:
            splash_logo_label = ctk.CTkLabel(center_frame, text="", image=self.logo_image_splash)
            splash_logo_label.pack(pady=20)
        else:
            splash_logo_label = ctk.CTkLabel(center_frame, text="🤖", font=("Arial", 100)) # Backup emoji
            splash_logo_label.pack(pady=20)
        splash_title_label = ctk.CTkLabel(center_frame, text="ARMS Register Bot", font=("Arial", 32, "bold"))
        splash_title_label.pack(pady=10)
        splash_loading_label = ctk.CTkLabel(center_frame, text="Loading...", font=("Arial", 16), text_color="gray")
        splash_loading_label.pack(pady=20)

    # --- Page 2: Dashboard Page ---
    def create_dashboard_widgets(self):
        """Creates the main Dashboard UI"""
        
        # --- Top Navbar ---
        navbar_frame = ctk.CTkFrame(self.dashboard_frame, height=50, corner_radius=0)
        navbar_frame.pack(fill="x", side="top")
        
        if self.logo_image_nav:
            nav_logo = ctk.CTkLabel(navbar_frame, text="", image=self.logo_image_nav)
            nav_logo.pack(side="left", padx=15, pady=10)
        
        # Navbar buttons on the right
        about_button = ctk.CTkButton(navbar_frame, text="ℹ️", width=40, font=("Arial", 20),
                                     command=self.show_about_page, fg_color="transparent", hover_color="#555")
        about_button.pack(side="right", padx=(5, 15), pady=10)
        
        log_button = ctk.CTkButton(navbar_frame, text="📋", width=40, font=("Arial", 20),
                                   command=self.show_log_page, fg_color="transparent", hover_color="#555")
        log_button.pack(side="right", padx=5, pady=10)
        
        settings_button = ctk.CTkButton(navbar_frame, text="⚙️", width=40, font=("Arial", 20),
                                        command=self.show_settings_page, fg_color="transparent", hover_color="#555")
        settings_button.pack(side="right", padx=5, pady=10)
        
        nav_title = ctk.CTkLabel(navbar_frame, text="Welcome to ARMS Course Register Bot", font=("Arial", 22, "bold"))
        nav_title.place(relx=0.5, rely=0.5, anchor="center")
        
        # --- Main Content Area (where bot cards appear) ---
        self.bot_list_frame = ctk.CTkScrollableFrame(self.dashboard_frame, fg_color="transparent")
        self.bot_list_frame.pack(fill="both", expand=True, padx=20, pady=20)

        # --- '+' Button Card (to add new bots) ---
        self.add_bot_card = ctk.CTkFrame(self.bot_list_frame, width=300, height=250)
        self.add_bot_card.pack(side="left", padx=10, pady=10) 
        self.add_bot_card.pack_propagate(False) 
        self.add_bot_card.bind("<Button-1>", lambda e: self.show_form_page())
        
        add_bot_button = ctk.CTkLabel(self.add_bot_card, text="+", font=("Arial", 100))
        add_bot_button.place(relx=0.5, rely=0.4, anchor="center")
        add_bot_button.bind("<Button-1>", lambda e: self.show_form_page())
        
        add_bot_label = ctk.CTkLabel(self.add_bot_card, text="Add New Bot Search", font=("Arial", 16))
        add_bot_label.place(relx=0.5, rely=0.8, anchor="center")
        add_bot_label.bind("<Button-1>", lambda e: self.show_form_page())
        
    # --- Page 3: Bot Form Page ---
    def create_form_widgets(self):
        """Creates all UI elements for the main bot form."""
        
        back_button = ctk.CTkButton(self.form_frame, text="< Back to Dashboard", 
                                    command=self.show_dashboard, fg_color="transparent",
                                    font=("Arial", 14, "bold"))
        back_button.pack(anchor="nw", padx=20, pady=(20, 0))
        
        header_frame = ctk.CTkFrame(self.form_frame, fg_color="transparent")
        header_frame.pack(pady=(0, 20)) 
        if self.logo_image_main:
            main_logo_label = ctk.CTkLabel(header_frame, text="", image=self.logo_image_main)
            main_logo_label.pack(side="left", padx=10)
        main_title_label = ctk.CTkLabel(header_frame, text="ARMS Register Bot", font=("Arial", 24, "bold"))
        main_title_label.pack(side="left", padx=10)
        
        self.username_label = ctk.CTkLabel(self.form_frame, text="ARMS Username (Register No):", font=("Arial", 14))
        self.username_label.pack(pady=(5, 5))
        self.username_validation_cmd = self.register(self.validate_username_realtime)
        self.username_entry = ctk.CTkEntry(self.form_frame, width=350, height=35, font=("Arial", 14),
                                           validate="key", validatecommand=(self.username_validation_cmd, '%P'))
        self.username_entry.pack(pady=5)
        self.username_error_label = ctk.CTkLabel(self.form_frame, text="", text_color="red", font=("Arial", 12))
        self.username_error_label.pack(pady=(0, 5))

        self.password_label = ctk.CTkLabel(self.form_frame, text="ARMS Password:", font=("Arial", 14))
        self.password_label.pack(pady=(5, 5))
        self.password_frame = ctk.CTkFrame(self.form_frame, fg_color="transparent", width=350, height=35)
        self.password_frame.pack(pady=5)
        self.password_validation_cmd = self.register(self.validate_password_realtime)
        self.password_entry = ctk.CTkEntry(self.password_frame, show="*", width=350, height=35, font=("Arial", 14),
                                           validate="key", validatecommand=(self.password_validation_cmd, '%P'))
        self.password_entry.place(x=0, y=0)
        self.password_entry.bind("<FocusOut>", self.on_password_focus_out)
        self.password_entry.bind("<FocusIn>", self.on_password_focus_in)
        self.toggle_pass_button = ctk.CTkButton(self.password_frame, text="👁️", width=35, height=27, font=("Arial", 16), 
            command=self.toggle_password_visibility, fg_color="#555", hover_color="#777")
        self.toggle_pass_button.place(x=310, y=4)
        self.password_error_label = ctk.CTkLabel(self.form_frame, text="", text_color="red", font=("Arial", 12))
        self.password_error_label.pack(pady=(0, 5))

        self.course_label = ctk.CTkLabel(self.form_frame, text="Course Code (e.g., SPIC706):", font=("Arial", 14))
        self.course_label.pack(pady=(5, 5))
        self.course_validation_cmd = self.register(self.validate_course_code_realtime)
        self.course_entry = ctk.CTkEntry(self.form_frame, width=350, height=35, font=("Arial", 14),
                                         validate="key", validatecommand=(self.course_validation_cmd, '%P'))
        self.course_entry.pack(pady=5)
        self.course_entry.bind("<FocusOut>", self.on_course_focus_out)
        self.course_entry.bind("<FocusIn>", self.on_course_focus_in)
        self.course_error_label = ctk.CTkLabel(self.form_frame, text="", text_color="red", font=("Arial", 12))
        self.course_error_label.pack(pady=(0, 5))

        self.slot_label_frame = ctk.CTkFrame(self.form_frame, fg_color="transparent")
        self.slot_label_frame.pack(pady=(5, 5))
        self.slot_label = ctk.CTkLabel(self.slot_label_frame, text="Slots to Search (e.g: A, B-D, F):", font=("Arial", 14))
        self.slot_label.pack(side="left")
        self.slot_validation_cmd = self.register(self.validate_slots_realtime)
        self.slot_entry = ctk.CTkEntry(self.form_frame, width=350, height=35, font=("Arial", 14),
                                       validate="key", validatecommand=(self.slot_validation_cmd, '%P'))
        self.slot_entry.pack(pady=5)
        self.slot_error_label = ctk.CTkLabel(self.form_frame, text="", text_color="red", font=("Arial", 12))
        self.slot_error_label.pack(pady=(0, 5))

        self.faculty_label = ctk.CTkLabel(self.form_frame, text="Ignore Faculty (comma separated):", font=("Arial", 14))
        self.faculty_label.pack(pady=(5, 5))
        self.faculty_entry = ctk.CTkEntry(self.form_frame, width=350, height=35, font=("Arial", 14), placeholder_text="Suresh, Kumar")
        self.faculty_entry.pack(pady=5)

        self.button_frame = ctk.CTkFrame(self.form_frame, fg_color="transparent")
        self.button_frame.pack(pady=20) 
        self.start_or_update_button = ctk.CTkButton(self.button_frame, text="Start Auto-Search", command=self.start_or_update_bot_thread, height=40, font=("Arial", 16), state="disabled")
        self.start_or_update_button.pack(side="left", padx=10)
        self.run_bg_button = ctk.CTkButton(self.button_frame, text="Run in Background", command=self.run_in_background, height=40, font=("Arial", 16), state="disabled")
        self.run_bg_button.pack(side="left", padx=10)
        self.stop_button = ctk.CTkButton(self.button_frame, text="Stop Bot", command=self.stop_bot, height=40, font=("Arial", 16), state="disabled", fg_color="red", hover_color="#990000")
        self.stop_button.pack(side="left", padx=10)
        self.status_label = ctk.CTkLabel(self.form_frame, text="Status: Ready", text_color="gray", font=("Arial", 16))
        self.status_label.pack(pady=10)

    # --- Page 4: Result Page ---
    def create_result_widgets(self):
        """Creates the page to show results after a successful run."""
        back_button = ctk.CTkButton(self.result_frame, text="< Back to Dashboard", 
                                    command=self.show_dashboard, fg_color="transparent",
                                    font=("Arial", 14, "bold"))
        back_button.pack(anchor="nw", padx=20, pady=(20, 0))

        result_center_frame = ctk.CTkFrame(self.result_frame, fg_color="transparent")
        result_center_frame.place(relx=0.5, rely=0.5, anchor="center")
        ctk.CTkLabel(result_center_frame, text="Registration Details", font=("Arial", 32, "bold")).pack(pady=20)
        self.result_status_label = ctk.CTkLabel(result_center_frame, text="Status: --", font=("Arial", 20, "bold"), text_color="lightgreen")
        self.result_status_label.pack(pady=(10, 20))
        self.result_course_label = ctk.CTkLabel(result_center_frame, text="Course Code: --", font=("Arial", 18))
        self.result_course_label.pack(pady=10, anchor="w")
        self.result_slot_label = ctk.CTkLabel(result_center_frame, text="Slot Selected: --", font=("Arial", 18))
        self.result_slot_label.pack(pady=10, anchor="w")
        self.result_faculty_label = ctk.CTkLabel(result_center_frame, text="Course Faculty: --", font=("Arial", 18))
        self.result_faculty_label.pack(pady=10, anchor="w")

    # --- Page 5: Settings Page ---
    def create_settings_widgets(self):
        """Creates the UI for the Settings page."""
        back_button = ctk.CTkButton(self.settings_frame, text="< Back to Dashboard", 
                                    command=self.show_dashboard, fg_color="transparent",
                                    font=("Arial", 14, "bold"))
        back_button.pack(anchor="nw", padx=20, pady=(20, 0))
        
        settings_center_frame = ctk.CTkFrame(self.settings_frame, fg_color="transparent")
        settings_center_frame.place(relx=0.5, rely=0.5, anchor="center")
        ctk.CTkLabel(settings_center_frame, text="App Settings", font=("Arial", 32, "bold")).pack(pady=20)
        
        ctk.CTkLabel(settings_center_frame, text="Global Username (Optional)", font=("Arial", 16)).pack(pady=(10,5), anchor="w")
        self.global_username_entry = ctk.CTkEntry(settings_center_frame, width=350, height=35, font=("Arial", 14),
                                                  placeholder_text="e.g., 1921...")
        self.global_username_entry.pack(pady=5)
        
        ctk.CTkLabel(settings_center_frame, text="Global Password (Optional)", font=("Arial", 16)).pack(pady=(10,5), anchor="w")
        self.global_password_entry = ctk.CTkEntry(settings_center_frame, width=350, height=35, font=("Arial", 14),
                                                  placeholder_text="Your ARMS password", show="*")
        self.global_password_entry.pack(pady=5)

        ctk.CTkLabel(settings_center_frame, text="Global Refresh Time (seconds)", font=("Arial", 16)).pack(pady=(20,5), anchor="w")
        self.global_refresh_entry = ctk.CTkEntry(settings_center_frame, width=150, height=35, font=("Arial", 14))
        self.global_refresh_entry.insert(0, "30") 
        self.global_refresh_entry.pack(pady=5, anchor="w")
        
        self.headless_checkbox_var = ctk.StringVar(value="off")
        headless_checkbox = ctk.CTkCheckBox(settings_center_frame, text="Run Browser Invisibly (Headless Mode)",
                                             variable=self.headless_checkbox_var, onvalue="on", offvalue="off",
                                             font=("Arial", 14))
        headless_checkbox.pack(pady=15, anchor="w")

        save_button = ctk.CTkButton(settings_center_frame, text="Save Settings", height=40, font=("Arial", 16),
                                    command=self.save_settings)
        save_button.pack(pady=20)
        
        self.settings_status_label = ctk.CTkLabel(settings_center_frame, text="", font=("Arial", 14), text_color="green")
        self.settings_status_label.pack()
        

    # --- Page 6: About Page ---
    def create_about_widgets(self):
        """Creates the About page with developer info and links."""
        back_button = ctk.CTkButton(self.about_frame, text="< Back to Dashboard", 
                                    command=self.show_dashboard, fg_color="transparent",
                                    font=("Arial", 14, "bold"))
        back_button.pack(anchor="nw", padx=20, pady=(20, 0))
        
        about_center_frame = ctk.CTkFrame(self.about_frame, fg_color="transparent")
        about_center_frame.place(relx=0.5, rely=0.5, anchor="center")

        ctk.CTkLabel(about_center_frame, text=f"ARMS Register Bot {CURRENT_VERSION}", font=("Arial", 32, "bold")).pack(pady=20)
        ctk.CTkLabel(about_center_frame, text="Developed By: Kalaiyarasan M", font=("Arial", 18, "bold")).pack(pady=5, anchor="w")
        
        # Links
        ctk.CTkLabel(about_center_frame, text="📧 Email: Cyberkalai14@gmail.com", font=("Arial", 18, "bold")).pack(pady=5, anchor="w")
        
        linkedin_link = ctk.CTkLabel(about_center_frame, text="🔗 LinkedIn: https://www.linkedin.com/in/cyberkalai/", font=("Arial", 18, "bold"), text_color="#0e76a8", cursor="hand2")
        linkedin_link.pack(pady=5, anchor="w")
        linkedin_link.bind("<Button-1>", lambda e: webbrowser.open_new("https://www.linkedin.com/in/cyberkalai/"))

        github_link = ctk.CTkLabel(about_center_frame, text="🔗 Github: https://github.com/kalaiyarasanDev/ARMS-Register-Bot", font=("Arial", 18, "bold"), text_color="#999999", cursor="hand2")
        github_link.pack(pady=5, anchor="w")
        github_link.bind("<Button-1>", lambda e: webbrowser.open_new("https://github.com/kalaiyarasanDev/ARMS-Register-Bot"))

        insta_link = ctk.CTkLabel(about_center_frame, text="🔗 Instagram: https://www.instagram.com/cyber_kalai/", font=("Arial", 18, "bold"), text_color="#E1306C", cursor="hand2")
        insta_link.pack(pady=5, anchor="w")
        insta_link.bind("<Button-1>", lambda e: webbrowser.open_new("https://www.instagram.com/cyber_kalai/"))

        # Note
        note_text = ("This is an open-source project. If you find any bugs or have any issues, "
                     "feel free to contact me. You are welcome to add modifications or new features as you see fit.")
        ctk.CTkLabel(about_center_frame, text="Note:", font=("Arial", 18, "bold")).pack(pady=(20, 5), anchor="w")
        ctk.CTkLabel(about_center_frame, text=note_text, font=("Arial", 16, "bold"), wraplength=500, justify="left").pack(pady=5, anchor="w")

    # --- Page 7: Log Page ---
    def create_log_widgets(self):
        """Creates the Bot Activity Log page."""
        back_button = ctk.CTkButton(self.log_frame, text="< Back to Dashboard", 
                                    command=self.show_dashboard, fg_color="transparent",
                                    font=("Arial", 14, "bold"))
        back_button.pack(anchor="nw", padx=20, pady=(20, 0))
        
        ctk.CTkLabel(self.log_frame, text="Bot Activity Log", font=("Arial", 32, "bold")).pack(pady=20)
        
        self.log_textbox = ctk.CTkTextbox(self.log_frame, state="disabled", font=("Courier New", 12))
        self.log_textbox.pack(fill="both", expand=True, padx=20, pady=(0, 10))
        
        clear_log_button = ctk.CTkButton(self.log_frame, text="Clear Log", command=self.clear_log, width=100)
        clear_log_button.pack(pady=(0, 10), padx=20, anchor="e")

        
    # --- Navigation Functions ---
    def show_dashboard(self):
        """Hides all other frames and shows the Dashboard frame."""
        self.splash_frame.pack_forget()
        self.form_frame.pack_forget()
        self.result_frame.pack_forget() 
        self.settings_frame.pack_forget()
        self.about_frame.pack_forget()
        self.log_frame.pack_forget()
        self.dashboard_frame.pack(fill="both", expand=True)

        # --- NEW: Show welcome popup if it's the first time ---
        if self.first_time_user:
            # Show the popup after a small delay to ensure dashboard is centered
            self.after(500, self.create_welcome_popup) 
        
        # Ensure the '+' card is always at the end
        self.add_bot_card.pack_forget()
        self.add_bot_card.pack(side="left", padx=10, pady=10)


    def show_form_page(self, event=None, bot_info=None): 
        """Shows the bot form, either for a new bot or in 'Edit Mode' for an existing one."""
        self.dashboard_frame.pack_forget()
        self.result_frame.pack_forget() 
        self.settings_frame.pack_forget() 
        self.about_frame.pack_forget()
        self.log_frame.pack_forget()

        if bot_info:
            # --- EDIT MODE ---
            self.current_viewed_bot = bot_info 
            self.reset_ui(clear_form=True) 
            self.username_entry.insert(0, bot_info['data']['username'])
            self.password_entry.insert(0, bot_info['data']['password'])
            self.course_entry.insert(0, bot_info['data']['course_code'])
            self.slot_entry.insert(0, bot_info['data']['slot_input_str'])
            self.faculty_entry.insert(0, bot_info['data']['ignore_faculty_str'])
            
            self.validate_username_realtime(self.username_entry.get())
            self.validate_password_realtime(self.password_entry.get())
            self.validate_course_code_realtime(self.course_entry.get())
            self.validate_slots_realtime(self.slot_entry.get())

            self.start_or_update_button.configure(text="Update & Relaunch", state="normal") 
            self.run_bg_button.configure(state="normal") 
            self.stop_button.configure(state="normal") 
            self.status_label.configure(text=bot_info["card_status_label"].cget("text"), 
                                        text_color=bot_info["card_status_label"].cget("text_color"))
        else:
            # --- NEW BOT MODE ---
            self.current_viewed_bot = None 
            self.reset_ui(clear_form=True)
            self.start_or_update_button.configure(text="Start Auto-Search") 
            
            # --- MODIFICATION: Pre-fill from global settings ---
            if self.global_username_entry.get():
                self.username_entry.insert(0, self.global_username_entry.get())
                self.validate_username_realtime(self.username_entry.get())
            if self.global_password_entry.get():
                self.password_entry.insert(0, self.global_password_entry.get())
                self.validate_password_realtime(self.password_entry.get())
            
        self.form_frame.pack(pady=20, padx=20, fill="both", expand=True)

    def show_result_page(self, result_data):
        """Shows the results page with data from a successful bot."""
        self.result_course_label.configure(text=f"Course Code: {result_data['course']}")
        self.result_slot_label.configure(text=f"Slot Selected: {result_data['slot']}")
        self.result_faculty_label.configure(text=f"Course Faculty: {result_data['faculty']}")
        self.result_status_label.configure(text="Status: ✅ REGISTERED!")
        self.dashboard_frame.pack_forget()
        self.form_frame.pack_forget()
        self.settings_frame.pack_forget()
        self.about_frame.pack_forget()
        self.log_frame.pack_forget()
        self.result_frame.pack(fill="both", expand=True)
        
    def show_settings_page(self):
        """Shows the settings page."""
        self.dashboard_frame.pack_forget()
        self.form_frame.pack_forget()
        self.result_frame.pack_forget()
        self.about_frame.pack_forget()
        self.log_frame.pack_forget()
        self.settings_frame.pack(fill="both", expand=True)
        self.settings_status_label.configure(text="") 

    def show_about_page(self):
        """Shows the about page."""
        self.dashboard_frame.pack_forget()
        self.form_frame.pack_forget()
        self.result_frame.pack_forget()
        self.settings_frame.pack_forget()
        self.log_frame.pack_forget()
        self.about_frame.pack(fill="both", expand=True)

    def show_log_page(self):
        """Shows the log page."""
        self.dashboard_frame.pack_forget()
        self.form_frame.pack_forget()
        self.result_frame.pack_forget()
        self.settings_frame.pack_forget()
        self.about_frame.pack_forget()
        self.log_frame.pack(fill="both", expand=True)

    # --- UI & Bot Control Functions ---
    
    # --- NEW: First-time user check ---
    def check_if_first_time(self):
        """Checks if a config file exists to determine first-time launch."""
        if not os.path.exists(CONFIG_FILE):
            self.first_time_user = True
            return
        
        try:
            with open(CONFIG_FILE, "r") as f:
                data = json.load(f)
                if data.get("first_time") == False:
                    self.first_time_user = False
                else:
                    self.first_time_user = True
        except:
            self.first_time_user = True # If file is corrupt, show card

    # --- NEW: Create Welcome Popup (Modal) ---
    def create_welcome_popup(self):
        """Creates a modal Toplevel window for the welcome message."""
        if self.welcome_popup and self.welcome_popup.winfo_exists():
            self.welcome_popup.focus() # Already open
            return

        popup_width = 750
        popup_height = 200
        
        self.welcome_popup = ctk.CTkToplevel(self)
        self.welcome_popup.title("Welcome!")
        
        # Center the popup
        screen_width = self.winfo_screenwidth()
        screen_height = self.winfo_screenheight()
        x = (screen_width // 2) - (popup_width // 2)
        y = (screen_height // 2) - (popup_height // 2)
        self.welcome_popup.geometry(f"{popup_width}x{popup_height}+{x}+{y}")

        self.welcome_popup.attributes("-topmost", True)
        self.welcome_popup.transient(self) 
        
        # --- MODIFICATION: Closing the window (X button) also dismisses it ---
        self.welcome_popup.protocol("WM_DELETE_WINDOW", self.dismiss_welcome_card)
        
        # --- Welcome Card UI ---
        welcome_frame = ctk.CTkFrame(self.welcome_popup, fg_color="#2B2B2B", corner_radius=10)
        welcome_frame.pack(fill="both", expand=True, padx=10, pady=10)

        welcome_title = ctk.CTkLabel(welcome_frame, text="👋 Welcome to the ARMS Bot!", font=("Arial", 20, "bold"))
        welcome_title.pack(pady=(15, 10), padx=20, anchor="w")
        
        welcome_text = ctk.CTkLabel(welcome_frame, text="This bot helps you automate course registration. Watch this quick 2-minute guide to get started!",
                                    font=("Arial", 14), wraplength=700, justify="left")
        welcome_text.pack(pady=5, padx=20, anchor="w")

        welcome_btn_frame = ctk.CTkFrame(welcome_frame, fg_color="transparent")
        welcome_btn_frame.pack(fill="x", padx=20, pady=(10, 15))

        # --- MODIFICATION: This button now also dismisses the card ---
        tutorial_btn = ctk.CTkButton(welcome_btn_frame, text="🎬 Watch Tutorial Video", command=self.open_tutorial_and_dismiss)
        tutorial_btn.pack(side="left")
        
        dismiss_btn = ctk.CTkButton(welcome_btn_frame, text="Dismiss", command=self.dismiss_welcome_card, fg_color="transparent", hover_color="#555")
        dismiss_btn.pack(side="right")
        
        self.welcome_popup.grab_set() # Make the popup modal

    # --- NEW: Dismiss Welcome Card ---
    def dismiss_welcome_card(self):
        """Hides the welcome card and saves the choice to config.json."""
        if not self.first_time_user: # Already dismissed
             if self.welcome_popup and self.welcome_popup.winfo_exists():
                self.welcome_popup.destroy()
             return

        self.log_message("Welcome card dismissed.")
        try:
            with open(CONFIG_FILE, "w") as f:
                json.dump({"first_time": False}, f) # Save the setting
            self.first_time_user = False
            
            if self.welcome_popup and self.welcome_popup.winfo_exists():
                self.welcome_popup.destroy() # Close the popup
                
        except Exception as e:
            self.log_message(f"Error saving config: {e}")
            if self.welcome_popup and self.welcome_popup.winfo_exists():
                self.welcome_popup.destroy() # Still close popup on error

    # --- NEW: Open Tutorial Link ---
    def open_tutorial(self):
        self.log_message("Opening tutorial video...")
        try:
            webbrowser.open_new(TUTORIAL_VIDEO_LINK)
        except Exception as e:
            self.log_message(f"Error opening link: {e}")
            self.show_popup_in_main_thread("Error", f"Could not open link. Please visit:\n{TUTORIAL_VIDEO_LINK}", "error")

    # --- NEW: Open Tutorial and Dismiss card ---
    def open_tutorial_and_dismiss(self):
        self.open_tutorial()
        self.dismiss_welcome_card()
    
    # --- NEW: Log Message Function ---
    def log_message(self, message):
        """Adds a timestamped message to the log page."""
        def _log():
            try:
                self.log_textbox.configure(state="normal")
                timestamp = time.strftime("[%Y-%m-%d %H:%M:%S]", time.localtime())
                self.log_textbox.insert("end", f"{timestamp} - {message}\n")
                self.log_textbox.configure(state="disabled")
                self.log_textbox.see("end") # Auto-scroll to bottom
            except Exception as e:
                print(f"Error logging message: {e}")
        self.after(0, _log) 

    # --- NEW: Clear Log Function ---
    def clear_log(self):
        """Clears all text from the log page."""
        try:
            self.log_textbox.configure(state="normal")
            self.log_textbox.delete("1.0", "end")
            self.log_textbox.configure(state="disabled")
        except Exception as e:
            print(f"Error clearing log: {e}")

    # --- MODIFICATION: Settings now save to config.json ---
    def save_settings(self):
        """Saves settings from the Settings page to config.json."""
        
        config_data = {}
        try:
            # Try to read existing data first (to keep 'first_time' setting)
            if os.path.exists(CONFIG_FILE):
                with open(CONFIG_FILE, "r") as f:
                    config_data = json.load(f)
        except Exception as e:
            print(f"Error reading config before saving: {e}") 

        # Update the dict with new settings
        config_data["global_username"] = self.global_username_entry.get()
        config_data["global_password"] = self.global_password_entry.get()
        config_data["global_refresh"] = self.global_refresh_entry.get()
        
        # Write EVERYTHING back to the file
        try:
            with open(CONFIG_FILE, "w") as f:
                json.dump(config_data, f, indent=4)
                
            self.log_message("Settings Saved.")
            self.settings_status_label.configure(text="✅ Settings Saved Successfully!")
            self.after(2000, lambda: self.settings_status_label.configure(text=""))
        except Exception as e:
            self.log_message(f"Error saving settings: {e}")
            self.settings_status_label.configure(text="❌ Error saving settings!", text_color="red")
    
    # --- NEW: Load settings from config.json on startup ---
    def load_settings(self):
        """Loads settings from config.json on app start."""
        if not os.path.exists(CONFIG_FILE):
            return # No settings to load

        try:
            with open(CONFIG_FILE, "r") as f:
                config_data = json.load(f)
            
            # Load and set values to the settings page widgets
            self.global_username_entry.insert(0, config_data.get("global_username", ""))
            self.global_password_entry.insert(0, config_data.get("global_password", ""))
            
            refresh_time = config_data.get("global_refresh", "30")
            self.global_refresh_entry.delete(0, "end")
            self.global_refresh_entry.insert(0, refresh_time)
            
            self.log_message("Global settings loaded from config.json.")
            
        except Exception as e:
            self.log_message(f"Error loading settings: {e}")

    
    def toggle_password_visibility(self):
        """Toggles password visibility in the form."""
        if self.is_password_visible:
            self.password_entry.configure(show="*")
            self.toggle_pass_button.configure(text="👁️")
            self.is_password_visible = False
        else:
            self.password_entry.configure(show="")
            self.toggle_pass_button.configure(text="🔒")
            self.is_password_visible = True
            
    # --- Validation Functions ---
    def validate_username_realtime(self, new_text):
        is_valid_syntax = False
        is_complete = False
        error_message = "" 
        if not new_text: 
            self.is_username_valid = False
            is_valid_syntax = True 
        elif re.fullmatch(r"^[0-9L]*$", new_text.upper()):
            is_valid_syntax = True
            if len(new_text) >= 9:
                is_complete = True
                self.is_username_valid = True
            else:
                self.is_username_valid = False
        else:
            self.is_username_valid = False
            error_message = "Invalid characters. Use only numbers (0-9) or 'L'." 
        if not is_valid_syntax and new_text: 
            self.username_entry.configure(border_color="red", border_width=2)
            self.username_error_label.configure(text=error_message) 
        else:
            self.username_entry.configure(border_color=self.default_border_color, border_width=self.default_border_width)
            self.username_error_label.configure(text="") 
        self.after(10, self.update_start_button_state)
        return True
        
    def on_password_focus_out(self, event):
        if not self.password_entry.get():
            self.password_entry.configure(border_color="red", border_width=2)
            self.password_error_label.configure(text="Password cannot be empty.")
            self.is_password_valid = False
        else:
            self.is_password_valid = True
        self.update_start_button_state() 

    def on_password_focus_in(self, event):
        self.password_entry.configure(border_color=self.default_border_color, border_width=self.default_border_width)
        self.password_error_label.configure(text="")

    def validate_password_realtime(self, new_text):
        self.password_entry.configure(border_color=self.default_border_color, border_width=self.default_border_width)
        self.password_error_label.configure(text="")
        if not new_text:
            self.is_password_valid = False
        else:
            self.is_password_valid = True
        self.after(10, self.update_start_button_state)
        return True

    def validate_course_code_realtime(self, new_text, event_type="key"):
        new_text = new_text.upper()
        is_valid_syntax = True
        is_complete = False
        show_error = False
        error_message = "" 
        if not new_text:
            self.is_course_valid = False
        elif new_text.startswith("SPIC"):
            if re.fullmatch(r"^SPIC[0-9]{1,3}$", new_text):
                is_complete = True
            elif re.fullmatch(r"^SPIC[0-9]{0,3}$", new_text):
                is_complete = False 
            else:
                is_valid_syntax = False 
                error_message = "Invalid format. (e.g., SPIC706)" 
        elif re.fullmatch(r"^[A-Z]{3}[0-9]{2,4}$", new_text):
            is_complete = True
        elif re.fullmatch(r"^[A-Z]{1,3}$", new_text):
             is_complete = False 
        elif re.fullmatch(r"^[A-Z]{3}[0-9]$", new_text):
            is_complete = False 
            if event_type == "focusout":
                show_error = True
                error_message = "Incomplete code. Must have 2-4 numbers." 
        elif re.fullmatch(r"^[A-Z]{3}[0-9]{0,4}$", new_text) or \
             re.fullmatch(r"^S$|^SP$|^SPI$", new_text):
             is_complete = False 
        else:
            is_valid_syntax = False
            error_message = "Invalid format. (e.g., CSE101 or SPIC706)" 
        if len(new_text) > 7:
            is_valid_syntax = False
            error_message = "Course code is too long (max 7 chars)." 
        if (not is_valid_syntax or show_error) and new_text:
            self.course_entry.configure(border_color="red", border_width=2)
            self.course_error_label.configure(text=error_message) 
        else:
            self.course_entry.configure(border_color=self.default_border_color, border_width=self.default_border_width)
            self.course_error_label.configure(text="") 
        self.is_course_valid = is_valid_syntax and is_complete
        self.after(10, self.update_start_button_state)
        return True
    
    def on_course_focus_out(self, event):
        self.validate_course_code_realtime(self.course_entry.get(), event_type="focusout")
    def on_course_focus_in(self, event):
        self.validate_course_code_realtime(self.course_entry.get(), event_type="key")

    def validate_slots_realtime(self, new_text):
        new_text = new_text.upper()
        is_valid = True
        error_message = "" 
        if not new_text: 
            self.is_slot_valid = False
        elif re.search(r"[^A-T,-]", new_text):
            is_valid = False
            error_message = "Invalid characters. Use only A-T, comma, or hyphen." 
        elif re.search(r",,|--|,-|-,", new_text):
            is_valid = False
            error_message = "Invalid format. Cannot have double operators." 
        elif new_text.startswith(',') or new_text.startswith('-') or \
             new_text.endswith(',') or new_text.endswith('-'):
            is_valid = False
            error_message = "Cannot start or end with a comma or hyphen." 
        else:
            parts = new_text.split(',')
            for part in parts:
                if not part: 
                    is_valid = False
                    error_message = "Invalid format. Check for double commas." 
                    break
                if part.count('-') > 1: 
                    is_valid = False
                    error_message = "Only one hyphen per range (e.g., A-D)." 
                    break
                elif '-' in part:
                    if not re.fullmatch(r"^[A-T]-[A-T]$", part):
                        is_valid = False
                        error_message = f"Invalid range format: '{part}'" 
                        break
                    start, end = part.split('-')
                    if start >= end: 
                        is_valid = False
                        error_message = f"Invalid range: '{part}'. Start must be before end." 
                        break
                elif not re.fullmatch(r"^[A-T]$", part): # AAAA
                    is_valid = False
                    error_message = f"Invalid slot: '{part}'. Use single letters A-T." 
                    break
        if is_valid and new_text:
            self.slot_entry.configure(border_color=self.default_border_color, border_width=self.default_border_width)
            self.slot_error_label.configure(text="") 
            self.is_slot_valid = True
        elif not new_text:
            self.slot_entry.configure(border_color=self.default_border_color, border_width=self.default_border_width)
            self.slot_error_label.configure(text="") 
            self.is_slot_valid = False
        else: 
            self.slot_entry.configure(border_color="red", border_width=2)
            self.slot_error_label.configure(text=error_message) 
            self.is_slot_valid = False
        self.after(10, self.update_start_button_state)
        return True

    def update_start_button_state(self):
        if self.is_username_valid and self.is_password_valid and self.is_course_valid and self.is_slot_valid:
            self.start_or_update_button.configure(state="normal")
        else:
            self.start_or_update_button.configure(state="disabled")

    def show_popup_in_main_thread(self, title, message, status_type):
        PopupMessage(title, message, status_type)

    def play_success_sound(self):
        try:
            import beepy as bp
            bp.beep(sound="coin")
        except Exception:
            winsound.MessageBeep(winsound.MB_OK) 
            
    def play_error_sound(self):
        try:
            winsound.MessageBeep(winsound.MB_ICONHAND) 
        except Exception as e:
            print(f"Could not play error sound: {e}")

    def parse_slots(self, slot_input):
        slot_input = slot_input.upper().replace(" ", "")
        final_slots = set()
        parts = slot_input.split(',')
        for part in parts:
            if '-' in part and len(part.split('-')) == 2:
                start, end = part.split('-')
                if len(start) == 1 and len(end) == 1:
                    for i in range(ord(start), ord(end) + 1):
                        final_slots.add(f"Slot {chr(i)}")
            elif len(part) == 1:
                final_slots.add(f"Slot {part}")
            elif part.startswith("SLOT"):
                final_slots.add(part.title())
        print(f"Parsed slots: {sorted(list(final_slots))}")
        return sorted(list(final_slots))

    def run_countdown(self, seconds, card_status_label):
        """A thread-safe countdown timer that updates the UI."""
        for i in range(seconds, -1, -1):
            if threading.main_thread().is_alive() and self.active_bots: # Check if app is still running
                current_thread = threading.current_thread()
                bot_to_stop = None
                for bot in self.active_bots:
                    if bot.get("thread") == current_thread:
                        bot_to_stop = bot
                        break
                
                if bot_to_stop and bot_to_stop["stop_event"].is_set():
                    break
                    
                status_text = f"Waiting... Next in {i}s"
                self.after(0, lambda: card_status_label.configure(text=status_text, text_color="gray"))
                
                # Also update form status if this is the currently viewed bot
                if self.current_viewed_bot and self.current_viewed_bot.get("thread") == current_thread:
                     self.after(0, lambda: self.status_label.configure(text=f"Status: {status_text}", text_color="gray"))

                time.sleep(1) 
            else:
                break
    
    def run_automation(self, bot_info):
        """The main bot logic that runs in a separate thread."""
        
        # --- Extract data from the bot_info dictionary ---
        data = bot_info['data']
        card_status_label = bot_info['card_status_label']
        stop_event = bot_info['stop_event']
        view_button = bot_info['view_button']
        stop_card_button = bot_info['stop_card_button']
        
        username = data['username']
        password = data['password']
        course_code = data['course_code']
        slot_input_str = data['slot_input_str']
        ignore_faculty_str = data['ignore_faculty_str']
        is_headless = data['is_headless'] # Get headless mode setting
        # --- End of data extraction ---

        slots_to_search_orig = self.parse_slots(slot_input_str)
        ignore_list = [name.strip().upper() for name in ignore_faculty_str.split(',') if name.strip()]
        
        try:
            loop_wait_time_seconds = int(self.global_refresh_entry.get())
        except:
            loop_wait_time_seconds = 30 
        
        driver = None 
        course_found_and_selected = False 
        
        bot_name = f"Bot({course_code} @ {username[-4:]})"

        # --- Helper functions to update UI safely from the thread ---
        def update_status(text, color):
            """Thread-safe UI update for card and form status."""
            try:
                self.after(0, lambda: card_status_label.configure(text=text, text_color=color))
                if self.current_viewed_bot == bot_info:
                    self.after(0, lambda: self.status_label.configure(text=f"Status: {text}", text_color=color))
            except Exception as e:
                pass # Card might be deleted, just ignore
        
        def log(message):
            """Thread-safe logging."""
            self.log_message(f"[{bot_name}] {message}")
        # --- End of helper functions ---


        try:
            update_status("Opening browser...", "yellow")
            log("Opening browser...")
            
            options = webdriver.ChromeOptions()
            options.add_argument("--start-maximized")
            if is_headless:
                options.add_argument("--headless")
                options.add_argument("--window-size=1920,1080")
                log("Running in Headless mode.")

            # --- NEW: Auto-driver ---
            driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()), options=options)
            
            driver.get('https://arms.sse.saveetha.com/Login.aspx')

            update_status("Logging in...", "yellow")
            log("Logging in...")
            
            WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.ID, "txtusername"))).send_keys(username)
            driver.find_element(By.ID, "txtpassword").send_keys(password)
            driver.find_element(By.ID, "btnlogin").click()
            
            error_message_id = "lblError" 
            
            try:
                WebDriverWait(driver, 10).until(
                    EC.any_of(
                        EC.presence_of_element_located((By.XPATH, "//*[contains(text(), 'Home')]")), 
                        EC.presence_of_element_located((By.ID, error_message_id)) 
                    )
                )
                
                try:
                    error_element = driver.find_element(By.ID, error_message_id)
                    error_text = error_element.text
                    if error_text: 
                        log(f"Login failed: {error_text}")
                        update_status("Login Failed!", "red")
                        self.after(0, self.play_error_sound)
                        self.after(0, lambda: self.show_popup_in_main_thread("Login Failed", f"❌ Username or Password wrong!\nNext: {error_text}", "error"))
                        stop_event.set() 
                        return 
                
                except Exception:
                    log("Login successful.")
                    pass 

            except Exception:
                log("Login timed out.")
                update_status("Login Timed Out!", "red")
                stop_event.set()
                return 
            
            update_status("Navigating...", "cyan")
            log("Navigating to Enrollment page.")
            driver.get("https://arms.sse.saveetha.com/StudentPortal/Enrollment.aspx")
            
            while not stop_event.is_set():
                
                # --- SMART BOT LOGIC: Filter out already taken slots ---
                with self.taken_slots_lock:
                    taken_slots_for_this_user = self.taken_slots_by_user.get(username, set())
                
                # The list of slots to search is the original list MINUS the ones already taken
                slots_to_search = [s for s in slots_to_search_orig if s not in taken_slots_for_this_user]
                
                if not slots_to_search:
                    log(f"All specified slots {slots_to_search_orig} are already taken by other bots. Stopping.")
                    update_status("All slots taken", "orange")
                    stop_event.set()
                    break
                # --- END OF SMART LOGIC ---

                for slot in slots_to_search:
                    if stop_event.is_set(): 
                        break
                    
                    update_status(f"Checking {slot}...", "cyan")
                    log(f"Checking {slot}...")
                    
                    try:
                        slot_dropdown = WebDriverWait(driver, 20).until(EC.element_to_be_clickable((By.ID, "cphbody_ddlslot")))
                        slot_dropdown.click()
                        time.sleep(0.5)
                    except Exception as e:
                        if stop_event.is_set(): break
                        log(f"Error clicking dropdown: {e}. Refreshing.")
                        update_status("Page Error. Refreshing...", "orange")
                        break 

                    try:
                        slot_option = WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, f"//option[text()='{slot}']")))
                        slot_option.click()
                        log(f"Selected '{slot}'.")
                        time.sleep(2) 
                    except Exception:
                        if stop_event.is_set(): break
                        log(f"'{slot}' not found or not clickable. Skipping.")
                        continue 

                    try:
                        course_radio_button_xpath = f"//label[contains(text(), '{course_code}')]/input[@type='radio']"
                        course_radio_button = driver.find_element(By.XPATH, course_radio_button_xpath)
                        
                        parent_label = course_radio_button.find_element(By.XPATH, "..")
                        
                        label_text_original = driver.execute_script("return arguments[0].textContent;", parent_label).strip()
                        label_text_upper = label_text_original.upper() 
                        
                        found_ignored_faculty = False
                        for faculty in ignore_list:
                            if faculty in label_text_upper: 
                                log(f"Course found, but IGNORING faculty: {faculty} in {slot}")
                                update_status(f"Ignoring {faculty} in {slot}", "orange")
                                found_ignored_faculty = True
                                break 
                        
                        if not found_ignored_faculty:
                            
                            course_radio_button.click()
                            log(f"Step 1: Selected course: {course_code} in {slot}")
                            update_status(f"Course {course_code} SELECTED...", "cyan")
                            time.sleep(1) 

                            log("Step 2: Clicking 'Send for Approval'...")
                            update_status("Sending for approval...", "yellow")
                            approval_button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "btnSave")))
                            approval_button.click()
                            
                            log("Step 3: Waiting for 'Yes' confirmation...")
                            update_status("Confirming 'Yes'...", "yellow")
                            yes_button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "cphbody_btnSubmit")))
                            yes_button.click()
                            
                            log(f"Successfully REGISTERED course: {course_code} in {slot}")
                            update_status("✅ REGISTERED!", "lightgreen")
                            
                            selected_faculty = "Unknown" 
                            try:
                                parts = label_text_original.split('-')
                                if len(parts) > 1:
                                    selected_faculty = parts[-1].strip()
                            except Exception as e:
                                log(f"Could not parse faculty name: {e}")

                            # --- SMART BOT: Broadcast that this slot is now taken ---
                            with self.taken_slots_lock:
                                self.taken_slots_by_user.setdefault(username, set()).add(slot)
                                log(f"Broadcasting: Slot {slot} is now taken for user {username}.")
                            
                            result_data = {"course": course_code, "slot": slot, "faculty": selected_faculty}
                            bot_info['result_data'] = result_data 
                            command_with_data = lambda b=bot_info: self.handle_view_more_click(b)
                            self.after(0, lambda: view_button.configure(state="normal", command=command_with_data))
                            self.after(0, lambda: stop_card_button.configure(state="disabled", text="Done"))

                            success_message = (
                                f"✅ Course Registered!\n\n"
                                f"   Slot: {slot}\n"
                                f"   Course: {course_code}\n"
                                f"   Faculty: {selected_faculty}\n\n"
                                f"Bot will now stop."
                            )
                            
                            self.after(0, self.play_success_sound)
                            self.after(0, lambda: self.show_popup_in_main_thread(
                                "Course Registered!", 
                                success_message, 
                                "success"
                            ))

                            course_found_and_selected = True
                            stop_event.set() 
                            break 

                    except Exception:
                        if stop_event.is_set(): break
                        log(f"Course '{course_code}' not found in {slot}.")
                        continue

                if course_found_and_selected or stop_event.is_set():
                    break 
                
                log(f"Course not found. Waiting {loop_wait_time_seconds}s...")
                self.run_countdown(loop_wait_time_seconds, card_status_label)
                
                if stop_event.is_set():
                    break 

                try:
                    update_status("Refreshing...", "yellow")
                    log("Refreshing page.")
                    driver.refresh()
                    WebDriverWait(driver, 20).until(EC.element_to_be_clickable((By.ID, "cphbody_ddlslot")))
                    log("Page refreshed.")
                except Exception as e:
                    if stop_event.is_set(): break
                    log(f"Error during refresh: {e}. Stopping bot.")
                    update_status("Refresh Error!", "red")
                    stop_event.set()
                    break

        except Exception as e:
            if not stop_event.is_set():
                log(f"A major error occurred: {e}")
                update_status("Major Error!", "red")
        
        finally:
            if driver:
                driver.quit() 
            log("Bot has stopped. Browser closed.")
            
            default_color = ctk.ThemeManager.theme["CTkButton"]["fg_color"]
            hover_color = ctk.ThemeManager.theme["CTkButton"]["hover_color"]
            
            # --- MODIFICATION: Add Delete button after bot stops ---
            def set_delete_button():
                try:
                    stop_card_button.configure(
                        text="Delete ❌", 
                        state="normal", 
                        fg_color=default_color, 
                        hover_color=hover_color, 
                        command=lambda b=bot_info: self.delete_bot_card(b))
                except Exception as e:
                    print(f"Error setting delete button, card deleted: {e}")

            if not course_found_and_selected:
                self.after(0, set_delete_button) 
                
                if not stop_event.is_set(): 
                    update_status("Error Stopped", "red")
                else: 
                     update_status("User Stopped", "orange")
                
                self.after(0, lambda: view_button.configure(state="normal")) 
            
            else:
                self.after(0, set_delete_button) 

            if self.current_viewed_bot == bot_info:
                self.after(100, self.reset_ui) 
            
            bot_info["thread"] = None

    # --- UI Control Functions (MODIFIED) ---
    
    def delete_bot_card(self, bot_info):
        """Removes a bot card from the dashboard."""
        self.log_message(f"Bot card for {bot_info['data']['course_code']} deleted.")
        bot_info["card"].destroy()
        
        if bot_info["stop_event"]:
            bot_info["stop_event"].set()
        self.active_bots = [b for b in self.active_bots if b != bot_info]
        if self.current_viewed_bot == bot_info:
            self.current_viewed_bot = None

    def handle_view_more_click(self, bot_info):
        """Decides which page to show when 'View More' is clicked."""
        
        if bot_info.get("thread") and bot_info["thread"].is_alive():
            # 1. Bot is still running -> show EDIT MODE
            self.show_form_page(bot_info=bot_info)
        elif "result_data" in bot_info and bot_info["result_data"]:
            # 2. Bot is finished and was successful -> show RESULT MODE
            self.show_result_page(bot_info["result_data"])
        else:
            # 3. Bot is finished and failed/stopped -> show EDIT MODE
            self.show_form_page(bot_info=bot_info)


    def start_or_update_bot_thread(self):
        """Starts a new bot or updates and relaunches an existing one."""
        
        if self.start_or_update_button.cget("state") == "disabled":
            self.status_label.configure(text="Status: Please fix the errors in red before starting.", text_color="red")
            return
            
        bot_data = {
            "username": self.username_entry.get(),
            "password": self.password_entry.get(),
            "course_code": self.course_entry.get().strip().upper(),
            "slot_input_str": self.slot_entry.get(),
            "ignore_faculty_str": self.faculty_entry.get(),
            "is_headless": self.headless_checkbox_var.get() == "on" # Get headless state
        }
        
        stop_event = threading.Event()
        bot_name = f"Bot({bot_data['course_code']} @ {bot_data['username'][-4:]})"

        if self.current_viewed_bot:
            # --- EDIT/RELAUNCH MODE ---
            self.log_message(f"Relaunching {bot_name} with new data.")
            bot_info = self.current_viewed_bot
            
            # Stop the old thread if it's running
            if bot_info["thread"] and bot_info["thread"].is_alive():
                bot_info["stop_event"].set() 
                bot_info["thread"].join() # Wait for it to close
            
            # Update the bot_info dict with new data
            bot_info["data"] = bot_data
            bot_info["stop_event"] = stop_event
            bot_info["result_data"] = None 
            
            # Update the existing card UI
            bot_info["card_status_label"].configure(text="Relaunching...", text_color="yellow")
            
            text_frame = bot_info["card"].winfo_children()[0] 
            labels = text_frame.winfo_children()
            labels[0].configure(text=f"Course: {bot_data['course_code']}") # Course
            labels[1].configure(text=f"Slots: {bot_data['slot_input_str']}") # Slots
            labels[2].configure(text=f"Ignoring: {bot_data['ignore_faculty_str'] if bot_data['ignore_faculty_str'] else 'None'}") # Ignoring
            
            # Reset card buttons
            bot_info["view_button"].configure(state="normal", command=lambda b=bot_info: self.handle_view_more_click(b))
            bot_info["stop_card_button"].configure(text="Stop", fg_color="red", hover_color="#990000", 
                                                   state="normal", command=lambda: stop_event.set())

        else:
            # --- NEW BOT MODE ---
            self.log_message(f"Starting new bot: {bot_name}")
            self.add_bot_card.pack_forget() # Hide the '+' card temporarily
            
            # Create a new card for the bot
            new_card = ctk.CTkFrame(self.bot_list_frame, width=300, height=250)
            new_card.pack(side="left", padx=10, pady=10)
            new_card.pack_propagate(False) 

            # Use grid for reliable layout inside the card
            new_card.grid_rowconfigure(1, weight=1) # Status label row expands
            new_card.grid_columnconfigure(0, weight=1)

            text_frame = ctk.CTkFrame(new_card, fg_color="transparent")
            text_frame.grid(row=0, column=0, sticky="new", padx=15, pady=10) 

            # --- MODIFICATION: Font size 14 ---
            ctk.CTkLabel(text_frame, text=f"Course: {bot_data['course_code']}", font=("Arial", 16, "bold"), anchor="w").pack(fill="x", pady=(5, 5))
            ctk.CTkLabel(text_frame, text=f"Slots: {bot_data['slot_input_str']}", font=("Arial", 14), anchor="w").pack(fill="x", pady=2)
            ctk.CTkLabel(text_frame, text=f"Ignoring: {bot_data['ignore_faculty_str'] if bot_data['ignore_faculty_str'] else 'None'}", font=("Arial", 14), anchor="w").pack(fill="x", pady=2)
            
            card_status_label = ctk.CTkLabel(new_card, text="Initializing...", font=("Arial", 14), text_color="gray", anchor="w")
            card_status_label.grid(row=1, column=0, sticky="nsew", padx=15, pady=10) 

            card_button_frame = ctk.CTkFrame(new_card, fg_color="transparent")
            card_button_frame.grid(row=2, column=0, sticky="sew", padx=5, pady=(5, 10))
            card_button_frame.grid_columnconfigure((0, 1), weight=1) 

            view_button = ctk.CTkButton(card_button_frame, text="View More", state="normal")
            view_button.grid(row=0, column=0, sticky="ew", padx=5)
            
            stop_card_button = ctk.CTkButton(card_button_frame, text="Stop", fg_color="red", hover_color="#990000", 
                                             command=lambda: stop_event.set())
            stop_card_button.grid(row=0, column=1, sticky="ew", padx=5)
            
            self.add_bot_card.pack(side="left", padx=10, pady=10) # Add the '+' card back
            
            bot_info = {
                "thread": None,
                "stop_event": stop_event,
                "card": new_card,
                "data": bot_data,
                "card_status_label": card_status_label,
                "view_button": view_button,
                "stop_card_button": stop_card_button,
                "result_data": None
            }
            
            view_button.configure(command=lambda b=bot_info: self.handle_view_more_click(b))
            self.active_bots.append(bot_info)
            self.current_viewed_bot = bot_info
        
        # --- Common logic for both modes ---
        
        self.start_or_update_button.configure(state="disabled") 
        self.stop_button.configure(state="normal") 
        self.run_bg_button.configure(state="normal")
        
        thread_args = (bot_info,)
        thread = threading.Thread(target=self.run_automation, args=thread_args)
        bot_info["thread"] = thread 
        
        if bot_info not in self.active_bots:
             self.active_bots.append(bot_info)
        
        thread.start()


    def run_in_background(self):
        """Switches to dashboard, leaves bot running in background."""
        self.log_message(f"Bot for {self.current_viewed_bot['data']['course_code']} running in background.")
        self.current_viewed_bot = None 
        self.show_dashboard()

    def stop_bot(self):
        """Stops the bot currently being viewed in the form page."""
        if self.current_viewed_bot:
            self.current_viewed_bot["stop_event"].set()     
            self.log_message(f"Stop signal sent to bot: {self.current_viewed_bot['data']['course_code']}")
            
            self.status_label.configure(text="Status: Stopping...", text_color="orange")
            self.stop_button.configure(state="disabled") 
            self.run_bg_button.configure(state="disabled")
            
            self.reset_ui(clear_form=False) 
            
        else:
            print("No bot is currently being viewed to stop.")

    def reset_ui(self, clear_form=False):
        """Resets the form page UI."""
        
        if self.current_viewed_bot is None:
             self.status_label.configure(text="Status: Ready", text_color="gray")
        
        self.stop_button.configure("disabled")
        self.run_bg_button.configure("disabled")
        
        self.update_start_button_state() 
        
        if clear_form:
            self.current_viewed_bot = None 
            self.username_entry.delete(0, 'end')
            self.password_entry.delete(0, 'end')
            self.course_entry.delete(0, 'end')
            self.slot_entry.delete(0, 'end')
            self.faculty_entry.delete(0, 'end')
            self.is_username_valid = False
            self.is_password_valid = False
            self.is_course_valid = False
            self.is_slot_valid = False
            self.start_or_update_button.configure(text="Start Auto-Search")
            self.update_start_button_state()

    # --- PUDHUSU: Auto-Updater Functions ---
    def start_update_check(self):
        """Starts the update check in a background thread."""
        self.log_message("Checking for updates...")
        update_thread = threading.Thread(target=self.check_for_updates)
        update_thread.daemon = True
        update_thread.start()

    def check_for_updates(self):
        """Fetches latest release info from GitHub and compares version."""
        try:
            response = requests.get(GITHUB_REPO_API_URL, timeout=5)
            response.raise_for_status() # Error panna ingaye stop aagidum
            
            latest_release_data = response.json()
            latest_version = latest_release_data.get("tag_name")
            
            if not latest_version:
                self.log_message("Could not find 'tag_name' in GitHub response.")
                return

            # Simple version comparison
            if latest_version > CURRENT_VERSION:
                self.log_message(f"New update found: {latest_version} (Current: {CURRENT_VERSION})")
                # UI changes must run on the main thread
                self.after(0, self.show_update_popup, latest_release_data)
            else:
                self.log_message(f"App is up-to-date (Version: {CURRENT_VERSION}).")

        except requests.exceptions.RequestException as e:
            self.log_message(f"Update check failed (network error): {e}")
        except Exception as e:
            self.log_message(f"Error checking updates: {e}")

    def show_update_popup(self, data):
        """Creates a modal popup asking the user to update."""
        latest_version = data.get("tag_name")
        download_url = None
        
        # Find the .exe file from the release assets
        for asset in data.get("assets", []):
            if asset.get("name", "").endswith(".exe"):
                download_url = asset.get("browser_download_url")
                break
        
        if not download_url:
            self.log_message("Update found, but no .exe download URL in assets.")
            return

        # Create the popup
        popup = ctk.CTkToplevel(self)
        popup.title("Update Available!")
        popup.geometry("400x150")
        popup.attributes("-topmost", True)
        popup.grab_set() # Make it modal

        label = ctk.CTkLabel(popup, text=f"A new version ({latest_version}) is available!\nWould you like to download and restart?", font=("Arial", 14))
        label.pack(pady=20)
        
        btn_frame = ctk.CTkFrame(popup, fg_color="transparent")
        btn_frame.pack(fill="x", pady=10)
        
        yes_btn = ctk.CTkButton(btn_frame, text="Yes, Update Now", command=lambda u=download_url: self.start_download(u, popup))
        yes_btn.pack(side="left", expand=True, padx=10)
        
        no_btn = ctk.CTkButton(btn_frame, text="Later", fg_color="transparent", hover_color="#555", command=popup.destroy)
        no_btn.pack(side="right", expand=True, padx=10)

    def start_download(self, url, popup):
        """Disables popup buttons and starts the download in a thread."""
        # Disable buttons
        for child in popup.winfo_children():
            if isinstance(child, ctk.CTkFrame):
                for btn in child.winfo_children():
                    btn.configure(state="disabled")

        popup.title("Downloading...")
        popup.winfo_children()[0].configure(text="Downloading update... Please wait.") # Update label
        
        # Start download in a thread to not freeze the popup
        download_thread = threading.Thread(target=self.download_and_restart, args=(url,))
        download_thread.daemon = True
        download_thread.start()

    def download_and_restart(self, url):
        """Downloads the new .exe and runs a .bat to restart the app."""
        try:
            self.log_message(f"Downloading update from {url}")
            response = requests.get(url)
            response.raise_for_status()
            
            # Save the new .exe as update.exe
            with open("update.exe", "wb") as f:
                f.write(response.content)
            
            self.log_message("Update downloaded. Preparing to restart.")

            # Get the name of the current running .exe file
            original_exe_name = os.path.basename(sys.executable) # e.g., "ARMS Register Bot.exe"
            
            # Create a .bat file to handle the replacement
            batch_script = f"""
            @echo off
            echo Waiting for app to close...
            timeout /t 2 /nobreak > NUL
            echo Deleting old version...
            del "{original_exe_name}"
            echo Renaming new version...
            ren "update.exe" "{original_exe_name}"
            echo Starting new version...
            start "" "{original_exe_name}"
            echo Cleaning up...
            del "%~f0"
            """
            
            with open("updater.bat", "w") as f:
                f.write(batch_script)
            
            # Run the .bat file and exit this app
            subprocess.Popen("updater.bat", shell=True)
            self.log_message("Restarting app...")
            
            # Use self.after to safely quit the app from the main thread
            self.after(0, self.quit)

        except Exception as e:
            self.log_message(f"Download/Restart failed: {e}")
            self.after(0, lambda: self.show_popup_in_main_thread("Error", f"Update failed: {e}\nPlease update manually.", "error"))


# --- Start the Application ---
if __name__ == "__main__":
    app = App()
    app.mainloop()

